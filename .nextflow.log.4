Dec-11 10:34:19.856 [main] DEBUG nextflow.cli.Launcher - $> nextflow run main.nf --samples /home/law22/data/LIV/MTAG/Input_files/COVID_severity.csv --outdir /home/law22/data/LIV/MTAG/Results/COVID_severity --mtag_dir /home/law22/data/LIV/MTAG/mtag
Dec-11 10:34:19.950 [main] DEBUG nextflow.cli.CmdRun - N E X T F L O W  ~  version 25.04.6
Dec-11 10:34:19.970 [main] DEBUG nextflow.plugin.PluginsFacade - Setting up plugin manager > mode=prod; embedded=false; plugins-dir=/home/law22/.nextflow/plugins; core-plugins: nf-amazon@2.15.0,nf-azure@1.16.0,nf-cloudcache@0.4.3,nf-codecommit@0.2.3,nf-console@1.2.1,nf-google@1.21.1,nf-k8s@1.0.0,nf-tower@1.11.4,nf-wave@1.12.1
Dec-11 10:34:19.992 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Enabled plugins: []
Dec-11 10:34:19.993 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Disabled plugins: []
Dec-11 10:34:19.995 [main] INFO  org.pf4j.DefaultPluginManager - PF4J version 3.12.0 in 'deployment' mode
Dec-11 10:34:20.006 [main] INFO  org.pf4j.AbstractPluginManager - No plugins
Dec-11 10:34:20.023 [main] DEBUG nextflow.config.ConfigBuilder - Found config local: /home/law22/data/LIV/scripts/nextflow-project-template/nextflow.config
Dec-11 10:34:20.025 [main] DEBUG nextflow.config.ConfigBuilder - Parsing config file: /home/law22/data/LIV/scripts/nextflow-project-template/nextflow.config
Dec-11 10:34:20.050 [main] DEBUG n.secret.LocalSecretsProvider - Secrets store: /home/law22/.nextflow/secrets/store.json
Dec-11 10:34:20.053 [main] DEBUG nextflow.secret.SecretsLoader - Discovered secrets providers: [nextflow.secret.LocalSecretsProvider@4bdc8b5d] - activable => nextflow.secret.LocalSecretsProvider@4bdc8b5d
Dec-11 10:34:20.065 [main] DEBUG nextflow.config.ConfigBuilder - Applying config profile: `standard`
Dec-11 10:34:20.582 [main] DEBUG nextflow.cli.CmdRun - Applied DSL=2 from script declaration
Dec-11 10:34:20.594 [main] DEBUG nextflow.cli.CmdRun - Launching `main.nf` [dreamy_lovelace] DSL2 - revision: 9ca90e9fd7
Dec-11 10:34:20.596 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins default=[]
Dec-11 10:34:20.596 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins resolved requirement=[]
Dec-11 10:34:20.641 [main] DEBUG nextflow.Session - Session UUID: 7dafd89a-c47f-47b8-b3c6-c1521980a511
Dec-11 10:34:20.641 [main] DEBUG nextflow.Session - Run name: dreamy_lovelace
Dec-11 10:34:20.642 [main] DEBUG nextflow.Session - Executor pool size: 180
Dec-11 10:34:20.649 [main] DEBUG nextflow.file.FilePorter - File porter settings maxRetries=3; maxTransfers=50; pollTimeout=null
Dec-11 10:34:20.655 [main] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'FileTransfer' minSize=10; maxSize=540; workQueue=LinkedBlockingQueue[-1]; allowCoreThreadTimeout=false
Dec-11 10:34:20.673 [main] DEBUG nextflow.cli.CmdRun - 
  Version: 25.04.6 build 5954
  Created: 01-07-2025 11:27 UTC (12:27 BST)
  System: Linux 6.14.0-33-generic
  Runtime: Groovy 4.0.26 on OpenJDK 64-Bit Server VM 21.0.9+10-Ubuntu-125.04
  Encoding: UTF-8 (UTF-8)
  Process: 617725@landmark-lv-02 [10.57.0.136]
  CPUs: 180 - Mem: 377.6 GB (303 GB) - Swap: 0 (0)
Dec-11 10:34:20.692 [main] DEBUG nextflow.Session - Work-dir: /home/law22/data/LIV/scripts/nextflow-project-template/work [ext2/ext3]
Dec-11 10:34:20.709 [main] DEBUG nextflow.executor.ExecutorFactory - Extension executors providers=[]
Dec-11 10:34:20.718 [main] DEBUG nextflow.Session - Observer factory: DefaultObserverFactory
Dec-11 10:34:20.723 [main] DEBUG nextflow.Session - Observer factory (v2): LinObserverFactory
Dec-11 10:34:20.746 [main] DEBUG nextflow.cache.CacheFactory - Using Nextflow cache factory: nextflow.cache.DefaultCacheFactory
Dec-11 10:34:20.754 [main] DEBUG nextflow.util.CustomThreadPool - Creating default thread pool > poolSize: 181; maxThreads: 1000
Dec-11 10:34:20.857 [main] DEBUG nextflow.Session - Session start
Dec-11 10:34:21.092 [main] DEBUG nextflow.script.ScriptRunner - > Launching execution
Dec-11 10:34:21.105 [main] INFO  nextflow.Nextflow - MTAG-flow - Pairwise MTAG Pipeline
===================================
GWAS CSV     : /home/law22/data/LIV/MTAG/Input_files/COVID_severity.csv
Output dir   : /home/law22/data/LIV/MTAG/Results/COVID_severity
MTAG code    : /home/law22/data/LIV/MTAG/mtag

Dec-11 10:34:21.230 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Dec-11 10:34:21.230 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Dec-11 10:34:21.235 [main] DEBUG nextflow.executor.Executor - [warm up] executor > local
Dec-11 10:34:21.241 [main] DEBUG n.processor.LocalPollingMonitor - Creating local task monitor for executor 'local' > cpus=180; memory=377.6 GB; capacity=180; pollInterval=100ms; dumpInterval=5m
Dec-11 10:34:21.243 [main] DEBUG n.processor.TaskPollingMonitor - >>> barrier register (monitor: local)
Dec-11 10:34:21.265 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'RUN_MTAG': maxForks=0; fair=false; array=0
Dec-11 10:34:21.290 [main] DEBUG nextflow.Session - Workflow process names [dsl2]: RUN_MTAG
Dec-11 10:34:21.292 [main] DEBUG nextflow.Session - Igniting dataflow network (2)
Dec-11 10:34:21.298 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > RUN_MTAG
Dec-11 10:34:21.299 [main] DEBUG nextflow.script.ScriptRunner - Parsed script files:
  Script_a259b011fd25f67e: /home/law22/data/LIV/scripts/nextflow-project-template/main.nf
Dec-11 10:34:21.299 [main] DEBUG nextflow.script.ScriptRunner - > Awaiting termination 
Dec-11 10:34:21.299 [main] DEBUG nextflow.Session - Session await
Dec-11 10:34:21.502 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.504 [Task submitter] INFO  nextflow.Session - [f6/16309a] Submitted process > RUN_MTAG (NDD)
Dec-11 10:34:21.512 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.513 [Task submitter] INFO  nextflow.Session - [59/b91207] Submitted process > RUN_MTAG (LBD)
Dec-11 10:34:21.516 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.517 [Task submitter] INFO  nextflow.Session - [ea/9f116c] Submitted process > RUN_MTAG (CBV)
Dec-11 10:34:21.521 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.522 [Task submitter] INFO  nextflow.Session - [2e/c4a9c5] Submitted process > RUN_MTAG (ICV)
Dec-11 10:34:21.526 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.527 [Task submitter] INFO  nextflow.Session - [73/b9cc78] Submitted process > RUN_MTAG (SCV)
Dec-11 10:34:21.530 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.530 [Task submitter] INFO  nextflow.Session - [0d/8ef8f5] Submitted process > RUN_MTAG (ALS)
Dec-11 10:34:21.534 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.535 [Task submitter] INFO  nextflow.Session - [76/f97b2d] Submitted process > RUN_MTAG (HL)
Dec-11 10:34:21.538 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.538 [Task submitter] INFO  nextflow.Session - [be/bb5b95] Submitted process > RUN_MTAG (HV_L)
Dec-11 10:34:21.542 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.542 [Task submitter] INFO  nextflow.Session - [12/e392f3] Submitted process > RUN_MTAG (HV)
Dec-11 10:34:21.547 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.548 [Task submitter] INFO  nextflow.Session - [6f/764aac] Submitted process > RUN_MTAG (AD)
Dec-11 10:34:21.568 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.570 [Task submitter] INFO  nextflow.Session - [ff/6c3d98] Submitted process > RUN_MTAG (PD)
Dec-11 10:34:21.585 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.586 [Task submitter] INFO  nextflow.Session - [5d/4376f6] Submitted process > RUN_MTAG (FTD)
Dec-11 10:34:21.596 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.601 [Task submitter] INFO  nextflow.Session - [a6/a04626] Submitted process > RUN_MTAG (HV_R)
Dec-11 10:34:21.613 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Dec-11 10:34:21.614 [Task submitter] INFO  nextflow.Session - [b7/5dd89a] Submitted process > RUN_MTAG (EPI)
Dec-11 10:34:41.553 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 12; name: RUN_MTAG (NDD); status: COMPLETED; exit: 0; error: -; workDir: /home/law22/data/LIV/scripts/nextflow-project-template/work/f6/16309a5e173c7c9a6d717b6539a345]
Dec-11 10:34:41.554 [Task monitor] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'TaskFinalizer' minSize=10; maxSize=540; workQueue=LinkedBlockingQueue[-1]; allowCoreThreadTimeout=false
Dec-11 10:34:41.564 [TaskFinalizer-1] DEBUG nextflow.processor.TaskProcessor - Process `RUN_MTAG (NDD)` is unable to find [UnixPath]: `/home/law22/data/LIV/scripts/nextflow-project-template/work/f6/16309a5e173c7c9a6d717b6539a345/NDD_MTAG` (pattern: `NDD_MTAG`)
Dec-11 10:34:41.570 [TaskFinalizer-1] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=RUN_MTAG (NDD); work-dir=/home/law22/data/LIV/scripts/nextflow-project-template/work/f6/16309a5e173c7c9a6d717b6539a345
  error [nextflow.exception.MissingFileException]: Missing output file(s) `NDD_MTAG` expected by process `RUN_MTAG (NDD)`
Dec-11 10:34:41.592 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 9; name: RUN_MTAG (CBV); status: COMPLETED; exit: 0; error: -; workDir: /home/law22/data/LIV/scripts/nextflow-project-template/work/ea/9f116cc41a468d460d83c4a0d0bac1]
Dec-11 10:34:41.593 [TaskFinalizer-2] DEBUG nextflow.processor.TaskProcessor - Process `RUN_MTAG (CBV)` is unable to find [UnixPath]: `/home/law22/data/LIV/scripts/nextflow-project-template/work/ea/9f116cc41a468d460d83c4a0d0bac1/CBV_MTAG` (pattern: `CBV_MTAG`)
Dec-11 10:34:41.598 [TaskFinalizer-1] ERROR nextflow.processor.TaskProcessor - Error executing process > 'RUN_MTAG (NDD)'

Caused by:
  Missing output file(s) `NDD_MTAG` expected by process `RUN_MTAG (NDD)`


Command executed:

  python /home/law22/data/LIV/MTAG/mtag/mtag.py         --sumstats /home/law22/data/LIV/GWAS/Processed_Z/processed/COVID_severity_processedGRCh38.txt,/home/law22/data/LIV/GWAS/Processed_Z/processed/NDD_processedGRCh38.txt         --out /home/law22/data/LIV/MTAG/Results/COVID_severity/NDD_MTAG         --snp_name SNP         --a1_name A1         --a2_name A2         --z_name Z         --n_name N         --maf_min 0.01         --stream_stdout         --force

Command exit status:
  0

Command output:
  (empty)

Command error:
  <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
  <> Note:  It is recommended to run your own QC on the input before using this program. 
  <> Software-related correspondence: jjala.ssgac@gmail.com 
  <> All other correspondence: paturley@broadinstitute.org 
  <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
  
  
  Calling ./mtag.py \
  --force  \
  --z-name Z \
  --stream-stdout  \
  --n-name N \
  --a2-name A2 \
  --a1-name A1 \
  --snp-name SNP \
  --sumstats /home/law22/data/LIV/GWAS/Processed_Z/processed/COVID_severity_processedGRCh38.txt,/home/law22/data/LIV/GWAS/Processed_Z/processed/NDD_processedGRCh38.txt \
  --out /home/law22/data/LIV/MTAG/Results/COVID_severity/NDD_MTAG 
  
  Beginning MTAG analysis...
  MTAG will use the Z column for analyses.
  Read in Trait 1 summary statistics (6617737 SNPs) from /home/law22/data/LIV/GWAS/Processed_Z/processed/COVID_severity_processedGRCh38.txt ...
  <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
  Munging Trait 1  <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><
  <><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
  
  ERROR converting summary statistics:
  
  Traceback (most recent call last):
    File "/home/law22/data/LIV/MTAG/mtag/mtag_munge.py", line 814, in munge_sumstats
      raise ValueError('Found {num} different {C} columns'.format(C=head,num=str(numc)))
  ValueError: Found 2 different SNP columns
  
  
  Conversion finished at Thu Dec 11 10:34:40 2025
  Total time elapsed: 0.01s
  Found 2 different SNP columns
  Traceback (most recent call last):
    File "/home/law22/data/LIV/MTAG/mtag/mtag.py", line 1577, in <module>
      mtag(args)
    File "/home/law22/data/LIV/MTAG/mtag/mtag.py", line 1343, in mtag
      DATA_U, DATA, args = load_and_merge_data(args)
    File "/home/law22/data/LIV/MTAG/mtag/mtag.py", line 273, in load_and_merge_data
      GWAS_d[p], sumstats_format[p] = _perform_munge(args, GWAS_d[p], gwas_dat_gen, p)
    File "/home/law22/data/LIV/MTAG/mtag/mtag.py", line 166, in _perform_munge
      munged_results = munge_sumstats.munge_sumstats(argnames, write_out=False, new_log=False)
    File "/home/law22/data/LIV/MTAG/mtag/mtag_munge.py", line 814, in munge_sumstats
      raise ValueError('Found {num} different {C} columns'.format(C=head,num=str(numc)))
  ValueError: Found 2 different SNP columns
  Analysis terminated from error at Thu Dec 11 10:34:40 2025
  Total time elapsed: 18.8s

Work dir:
  /home/law22/data/LIV/scripts/nextflow-project-template/work/f6/16309a5e173c7c9a6d717b6539a345

Tip: you can try to figure out what's wrong by changing to the process work dir and showing the script file named `.command.sh`
Dec-11 10:34:41.600 [TaskFinalizer-2] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=RUN_MTAG (CBV); work-dir=/home/law22/data/LIV/scripts/nextflow-project-template/work/ea/9f116cc41a468d460d83c4a0d0bac1
  error [nextflow.exception.MissingFileException]: Missing output file(s) `CBV_MTAG` expected by process `RUN_MTAG (CBV)`
Dec-11 10:34:41.604 [TaskFinalizer-1] DEBUG nextflow.Session - Session aborted -- Cause: Missing output file(s) `NDD_MTAG` expected by process `RUN_MTAG (NDD)`
Dec-11 10:34:41.619 [main] DEBUG nextflow.Session - Session await > all processes finished
Dec-11 10:34:41.619 [main] DEBUG nextflow.Session - Session await > all barriers passed
Dec-11 10:34:41.619 [Task monitor] DEBUG n.processor.TaskPollingMonitor - <<< barrier arrives (monitor: local) - terminating tasks monitor poll loop
Dec-11 10:34:41.630 [main] WARN  n.processor.TaskPollingMonitor - Killing running tasks (12)
Dec-11 10:34:41.672 [main] DEBUG n.trace.WorkflowStatsObserver - Workflow completed > WorkflowStats[succeededCount=0; failedCount=2; ignoredCount=0; cachedCount=0; pendingCount=0; submittedCount=0; runningCount=0; retriesCount=0; abortedCount=12; succeedDuration=0ms; failedDuration=40s; cachedDuration=0ms;loadCpus=0; loadMemory=0; peakRunning=14; peakCpus=14; peakMemory=0; ]
Dec-11 10:34:41.813 [main] DEBUG nextflow.cache.CacheDB - Closing CacheDB done
Dec-11 10:34:41.820 [main] DEBUG nextflow.script.ScriptRunner - > Execution complete -- Goodbye
